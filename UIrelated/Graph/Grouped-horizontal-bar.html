<!DOCTYPE html>
<meta charset="utf-8">
<style>

	/*
	.chart rect {
	  fill: steelblue;
	}
	*/
	.chart .legend {
		fill: black;
		font: 14px sans-serif;
		text-anchor: start;
		font-size: 12px;
	}

	.chart text {
		fill: white;
		font: 10px sans-serif;
		text-anchor: end;
	}

	.chart .label {
		fill: black;
		font: 14px sans-serif;
		text-anchor: end;
	}

	.bar:hover {
		fill: brown;
	}

	.axis path,
	.axis line {
		fill: none;
		stroke: #000;
		shape-rendering: crispEdges;
	}


</style>
<svg class="chart"></svg>
<script src="../../Library/D3/d3.v4.min.js"></script>
<script>
	var categories = [];
	var total_values = [];
	var total_values_text = [];
	var period_values =[];
	var period_values_text =[];
	var temp_str = '';
	var temp_arr;

	categories.push('SENDOUT');
	total_values.push(parseInt('7.0'));
	if(parseInt('7.0') >= 86400){
		temp_arr = '0:00:07'.split(', ');
		temp_str = temp_arr[0];
		temp_arr = temp_str[1].split(':');
	}else{
		temp_arr = '0:00:07'.split(':');
	}


	if ( parseInt(temp_arr[0]) > 0 ){
		temp_str += " " + parseInt(temp_arr[0]) + ' Hour ';
	}

	if ( parseInt(temp_arr[1]) > 0 ){
		temp_str += " " + parseInt(temp_arr[1]) + ' Min ';
	}

	if ( parseInt(temp_arr[2]) > 0 ){
		temp_str += " " + parseInt(temp_arr[2]) + ' Second ';
	}

	total_values_text.push(temp_str);
	temp_str = '';

	categories.push('REVIEW');
	total_values.push(parseInt('9.0'));
	if(parseInt('9.0') >= 86400){
		temp_arr = '0:00:09'.split(', ');
		temp_str = temp_arr[0];
		temp_arr = temp_str[1].split(':');
	}else{
		temp_arr = '0:00:09'.split(':');
	}


	if ( parseInt(temp_arr[0]) > 0 ){
		temp_str += " " + parseInt(temp_arr[0]) + ' Hour ';
	}

	if ( parseInt(temp_arr[1]) > 0 ){
		temp_str += " " + parseInt(temp_arr[1]) + ' Min ';
	}

	if ( parseInt(temp_arr[2]) > 0 ){
		temp_str += " " + parseInt(temp_arr[2]) + ' Second ';
	}

	total_values_text.push(temp_str);
	temp_str = '';

	categories.push('APPROVED');
	total_values.push(parseInt('12964.3333333'));
	if(parseInt('12964.3333333') >= 86400){
		temp_arr = '3:36:04.333333'.split(', ');
		temp_str = temp_arr[0];
		temp_arr = temp_str[1].split(':');
	}else{
		temp_arr = '3:36:04.333333'.split(':');
	}


	if ( parseInt(temp_arr[0]) > 0 ){
		temp_str += " " + parseInt(temp_arr[0]) + ' Hour ';
	}

	if ( parseInt(temp_arr[1]) > 0 ){
		temp_str += " " + parseInt(temp_arr[1]) + ' Min ';
	}

	if ( parseInt(temp_arr[2]) > 0 ){
		temp_str += " " + parseInt(temp_arr[2]) + ' Second ';
	}

	total_values_text.push(temp_str);
	temp_str = '';

	categories.push('LAB');
	total_values.push(parseInt('0'));
	if(parseInt('0') >= 86400){
		temp_arr = '0:00:00'.split(', ');
		temp_str = temp_arr[0];
		temp_arr = temp_str[1].split(':');
	}else{
		temp_arr = '0:00:00'.split(':');
	}


	if ( parseInt(temp_arr[0]) > 0 ){
		temp_str += " " + parseInt(temp_arr[0]) + ' Hour ';
	}

	if ( parseInt(temp_arr[1]) > 0 ){
		temp_str += " " + parseInt(temp_arr[1]) + ' Min ';
	}

	if ( parseInt(temp_arr[2]) > 0 ){
		temp_str += " " + parseInt(temp_arr[2]) + ' Second ';
	}

	total_values_text.push(temp_str);
	temp_str = '';




	period_values.push( parseInt('7.0'));

	if(parseInt('7.0') >= 86400){
		temp_arr = '0:00:07'.split(', ');
		temp_str = temp_arr[0];
		temp_arr = temp_str[1].split(':');
	}else{
		temp_arr = '0:00:07'.split(':');
	}

	if ( parseInt(temp_arr[0]) > 0 ){
		temp_str += " " + parseInt(temp_arr[0]) + ' Hour ';
	}

	if ( parseInt(temp_arr[1]) > 0 ){
		temp_str += " " + parseInt(temp_arr[1]) + ' Min ';
	}

	if ( parseInt(temp_arr[2]) > 0 ){
		temp_str += " " + parseInt(temp_arr[2]) + ' Second ';
	}

	period_values_text.push(temp_str);
	temp_str = '';

	period_values.push( parseInt('9.0'));

	if(parseInt('9.0') >= 86400){
		temp_arr = '0:00:09'.split(', ');
		temp_str = temp_arr[0];
		temp_arr = temp_str[1].split(':');
	}else{
		temp_arr = '0:00:09'.split(':');
	}

	if ( parseInt(temp_arr[0]) > 0 ){
		temp_str += " " + parseInt(temp_arr[0]) + ' Hour ';
	}

	if ( parseInt(temp_arr[1]) > 0 ){
		temp_str += " " + parseInt(temp_arr[1]) + ' Min ';
	}

	if ( parseInt(temp_arr[2]) > 0 ){
		temp_str += " " + parseInt(temp_arr[2]) + ' Second ';
	}

	period_values_text.push(temp_str);
	temp_str = '';

	period_values.push( parseInt('12964.3333333'));

	if(parseInt('12964.3333333') >= 86400){
		temp_arr = '3:36:04.333333'.split(', ');
		temp_str = temp_arr[0];
		temp_arr = temp_str[1].split(':');
	}else{
		temp_arr = '3:36:04.333333'.split(':');
	}

	if ( parseInt(temp_arr[0]) > 0 ){
		temp_str += " " + parseInt(temp_arr[0]) + ' Hour ';
	}

	if ( parseInt(temp_arr[1]) > 0 ){
		temp_str += " " + parseInt(temp_arr[1]) + ' Min ';
	}

	if ( parseInt(temp_arr[2]) > 0 ){
		temp_str += " " + parseInt(temp_arr[2]) + ' Second ';
	}

	period_values_text.push(temp_str);
	temp_str = '';

	period_values.push( parseInt('0'));

	if(parseInt('0') >= 86400){
		temp_arr = '0:00:00'.split(', ');
		temp_str = temp_arr[0];
		temp_arr = temp_str[1].split(':');
	}else{
		temp_arr = '0:00:00'.split(':');
	}

	if ( parseInt(temp_arr[0]) > 0 ){
		temp_str += " " + parseInt(temp_arr[0]) + ' Hour ';
	}

	if ( parseInt(temp_arr[1]) > 0 ){
		temp_str += " " + parseInt(temp_arr[1]) + ' Min ';
	}

	if ( parseInt(temp_arr[2]) > 0 ){
		temp_str += " " + parseInt(temp_arr[2]) + ' Second ';
	}

	period_values_text.push(temp_str);
	temp_str = '';



console.log(period_values, period_values_text);
	var data = {
		labels: categories,
		series: [
			{
				label: 'Total Average Time',
				values: total_values
			},

			{
				label: 'Period Ave Time',
				values: period_values
			},]
	};

	var chartWidth       = 400,
			barHeight        = 20,
			groupHeight      = barHeight * data.series.length,
			gapBetweenGroups = 10,
			spaceForLabels   = 150,
			spaceForLegend   = 150;

	// Zip the series data together (first values, second values, etc.)
	var zippedData = [];
	for (var i=0; i<data.labels.length; i++) {
		for (var j=0; j<data.series.length; j++) {
			zippedData.push(data.series[j].values[i]);
		}
	}

	// Color scale
	var color = d3.scaleOrdinal(d3.schemeCategory10);
	var chartHeight = barHeight * zippedData.length + gapBetweenGroups * data.labels.length;

	var x = d3.scaleLinear()
	.domain([0, d3.max(zippedData)])
	.range([0, chartWidth]);

	var y = d3.scaleLinear()
	.range([chartHeight + gapBetweenGroups, 0]);

	var xAxis = d3.axisBottom(x)
	.tickSize(1)
	.tickFormat('');

	var yAxis = d3.axisLeft(y)
	.tickSize(0)
	.tickFormat('');

	// Specify the chart area and dimensions
	var chart = d3.select(".chart")
	.attr("width", spaceForLabels + chartWidth + spaceForLegend)
	.attr("height", chartHeight);

	// Create bars
	var bar = chart.selectAll("g")
	.data(zippedData)
	.enter().append("g")
	.attr("transform", function(d, i) {
		return "translate(" + spaceForLabels + "," + (i * barHeight + gapBetweenGroups * (0.5 + Math.floor(i/data.series.length))) + ")";
	});

	// Create rectangles of the correct width
	bar.append("rect")
	.attr("fill", function(d,i) { console.log(d, i, color(i % data.series.length)); return color(i % data.series.length); })
//	.attr('fill', function (d, i) { return color(i); })
	.attr("class", "bar")
	.attr("width", x)           // need scale ..

	.attr("height", barHeight - 1);

	// Add text label in bar
	bar.append("text")
	.attr("x", function(d) { return x(d) - 3; })
	.attr("y", barHeight / 2)
	.attr("fill", "red")
	.attr('stroke', 'red')
	.attr("dy", ".35em")
	.text(function(d) { return d; });

	// Draw labels
	bar.append("text")
	.attr("class", "label")
	.attr("x", function(d) { return - 20; })
	.attr("y", groupHeight / 2)
	.attr("dy", ".35em")
	.text(function(d,i) {
		if (i % data.series.length === 0)
			return data.labels[Math.floor(i/data.series.length)];
		else
			return ""});

//	// Add custom text label in bar
//	bar.append("text")
//	.attr("x", function(d) { return x(d)+100; })
//	.attr("y", barHeight / 2)
//	.attr("fill", "red")
//	.attr("dy", ".35em")
//	.text(function(d) { return 'test'; });

	chart.append("g")
	.attr("class", "y axis")
	.attr("transform", "translate(" + spaceForLabels + ", " + -gapBetweenGroups/2 + ")")
	.call(yAxis);

console.log(spaceForLabels, groupHeight, gapBetweenGroups, data.labels.length, (groupHeight + gapBetweenGroups) * data.labels.length);
	chart.append("g")
	.attr("class", "x axis")
	.attr("transform", "translate(" + spaceForLabels + ", " + ( (groupHeight + gapBetweenGroups) * data.labels.length - 1) + ")")
	.call(xAxis);

	// Draw legend
	var legendRectSize = 18,
			legendSpacing  = 4;

	var legend = chart.selectAll('.legend')
	.data(data.series)
	.enter()
	.append('g')
	.attr('transform', function (d, i) {
		var height = legendRectSize + legendSpacing;
		var offset = -gapBetweenGroups/2;
		var horz = spaceForLabels + chartWidth + 40 - legendRectSize;
		var vert = i * height - offset;
		return 'translate(' + horz + ',' + vert + ')';
	});

	legend.append('rect')
	.attr('width', legendRectSize)
	.attr('height', legendRectSize)
	.style('fill', function (d, i) { return color(i); })
	.style('stroke', function (d, i) { return color(i); });

	legend.append('text')
	.attr('class', 'legend')
	.attr('x', legendRectSize + legendSpacing)
	.attr('y', legendRectSize - legendSpacing)
	.text(function (d) { return d.label; });

</script>